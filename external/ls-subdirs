#!/bin/sh

if [ $# -ne 1 ]
then
	echo "USAGE: $0 <path from external>"
	exit 1
fi

cd "`git rev-parse --show-toplevel`/external"

modulename="`echo "$1" | cut -d/ -f1`"
treename="`echo "$1" | sed -n 's:[^/]*/\(.*\):\1:p'`"
gitname="../.git/modules/external/$modulename"

if ! [ -e "$gitname" ]
then
	git submodule update --init "$modulename" >&2
	git submodule deinit "$modulename" >&2
fi
git -C "$gitname" ls-tree -d --name-only "HEAD:$treename"
